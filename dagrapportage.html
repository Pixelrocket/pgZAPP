<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="robots" content="noindex, follow">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ZAPP - Dagrapportage</title>
	<link rel="stylesheet" href="css/themes/default/jquery.mobile-1.3.1.min.css">
	<link rel="stylesheet" href="css/custom.css">
	<link rel="stylesheet" href="css/jquery.mobile.simpledialog.min.css">
	<link rel="shortcut icon" href="favicon.ico">
	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,700">
	<script src="js/jquery.js"></script>
	<script src="js/jquery.mobile-1.3.1.min.js"></script>
	<script src="js/jquery.mobile.simpledialog2.min.js"></script>
	<script src="js/jquery.validate.js"></script>
	<script src="js/jquery.total-storage.min.js"></script>
	<script type="text/javascript">/*<![CDATA[*/
		// controleer of de user wel toegang heeft
		if( $.totalStorage('loggedin') != 1 ) {
			$.totalStorage('loggedin',0);
			$.totalStorage.deleteItem('user_id');
			$.totalStorage.deleteItem('user_name');
			window.location = 'index.html';
		}
		// check of totalStorage.activeClient wel bestaat... Zo nee, dan zetten.
		if ($.totalStorage('activeClient') == null) {
			$.totalStorage('activeClient',0);
		}
		// URL voor clienten
		var WSClienturl = $.totalStorage('pathCFC') + "getClients";
		// functie voor het ophalen van de clienten
		function getClients(account_id,active_client) {
			$.ajax({
					url			: WSClienturl,
					type		: 'GET',
					data		: { accountid: account_id },
					contentType	: "application/json; charset=utf-8",
				    dataType	: "JSON",
					statusCode	: {
									200: function(data) {
										if (data == '[]' || data == []) {
											alert("fout200");
										}
										else {
											/* kijk of er wel een client is gekozen. Zo ja, zet TotalStorage,
											 zo nee, zet 'm op de eerste en dan in TotalStorage*/
											if (active_client == 0) {
												$.totalStorage('activeClient',data[0]['clientid']);
											} else {
												$.totalStorage('activeClient',active_client);
											}
											var strClienten = '';
											for (var key=0, size=data.length; key<size;key++) {
												var liOpen = '<li>';
												if (data[key]['clientid'] == $.totalStorage('activeClient')) {
													liOpen = '<li class="menuActive">';
													$('#title').html(data[key]['clientnameinformal'] + ' - Dagrapportage');
													getDailyReports($.totalStorage('activeClient'));
												}
												strClienten += liOpen + '<a href="#" onClick="getClients(' + $.totalStorage('account_id') + ',' + data[key]['clientid'] + ')">' + data[key]['clientnameinformal'] + '</a></li>';
											}
											$('#clientlist').html(strClienten);
										};

									},
									202: function(err) {
										alert("fout202");
									}
								}
			});
		}
		// URL voor dagrapportages
		var WSReportsurl = $.totalStorage('pathCFC') + "getDailyReports";
		// functie voor het ophalen van de dagrapportages
		function getDailyReports(clientid) {
			$.ajax({
					url			: WSReportsurl,
					type		: 'GET',
					data		: { clientid: clientid },
					contentType	: "application/json; charset=utf-8",
				    dataType	: "JSON",
					statusCode	: {
									200: function(data) {
										if (data == '[]' || data == []) {
											alert("fout200");
										}
										else {
											var strReports = '';
											if (data.length == 0) {
												strReports += 'Er zijn geen dagrapportages beschikbaar';
											} else {
												strReports = '<div class="ui-grid-b">';
													for (var key=0, size=data.length; key<size;key++) {
													strReports += '<div class="ui-block-a">xxx</div>';
												}
												strReports += '</div>';
											};
											//$('#content').html(strReports);
										};

									},
									202: function(err) {
										alert("fout202");
									}
								}
			});
		}
		// haal de clienten op voor de eerste keer
		getClients($.totalStorage('account_id'),$.totalStorage('activeClient'));
	/*]]>*/</script>

<script>
	function changePanelArrow()
{
$('#open-menu').attr("data-icon", "arrow-l");
}
</script>
</head>
<body>
<div data-role="page" id="page">
	<div data-role="panel" id="mypanel" data-position="left" data-display="push" data-position-fixed="true" data-dismissible="true" data-theme="b">
		<ul id="clientlist">
		</ul>
		<a href="#open-menu" data-rel="close" data-role="button" data-theme="b" data-icon="delete" data-inline="true">sluit</a>
	</div>
	<div data-role="header" data-theme="b">
		<a href="#mypanel" id="open-menu" data-icon="arrow-r" onclick="changePanelArrow()">menu</a>
		<h1 id="title">Dagrapportage</h1>
	</div>
	<div data-role="content" id="content" data-inset="true">


		<ul data-role="listview" data-inset="false">
			<li>

				<h3>jQuery Team</h3>
				<p><strong>Boston Conference Planning</strong></p>
				<p>In preparation for the upcoming conference in Boston, we need to start gathering a list of sponsors and speakers.</p>
				<p class="ui-li-aside"><strong>9:18</strong>AM</p>

			</li>
		</ul>



	</div>
</div>
</body>
</html>